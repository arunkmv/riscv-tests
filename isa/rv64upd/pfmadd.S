#include "riscv_test.h"
#include "test_macros.h"

RVTEST_RV64UF
RVTEST_CODE_BEGIN

#if __riscv_xlen == 32
    # Replace the function with the 32-bit variant defined in test_macros.h
    #undef TEST_PA_OP3_D
    #define TEST_PA_OP3_D TEST_PA_OP3_D32
#endif

  #-------------------------------------------------------------
  # Arithmetic tests
  #-------------------------------------------------------------

  TEST_PA_OP3_D( 2,  fmadd.d, 0, 0x4700000000000000, 0x4000000000000000, 0x4500000000000000, 0x4000000000000000); #                3.5 =   ( 1.0 *     2.5) +  1.0
  TEST_PA_OP3_D( 3,  fmadd.d, 0, 0x646A19999999998D, 0xC000000000000000, 0x9B96733333333340, 0x4066666666666680); # 1236.1999999999999 =   (-1.0 * -1235.1) +  1.1
  TEST_PA_OP3_D( 4,  fmadd.d, 0, 0xB200000000000000, 0x4400000000000000, 0xB700000000000000, 0xBC00000000000000); #              -12.0 =   ( 2.0 *    -5.0) + -2.0

  TEST_PA_OP3_D( 5, fnmadd.d, 0, 0xB900000000000000, 0x4000000000000000, 0x4500000000000000, 0x4000000000000000); #               -3.5 = -(( 1.0 *     2.5) +  1.0)
  TEST_PA_OP3_D( 6, fnmadd.d, 0, 0x9B95E66666666673, 0xC000000000000000, 0x9B96733333333340, 0x4066666666666680); #-1236.1999999999999 = -((-1.0 * -1235.1) +  1.1)
  TEST_PA_OP3_D( 7, fnmadd.d, 0, 0x4E00000000000000, 0x4400000000000000, 0xB700000000000000, 0xBC00000000000000); #               12.0 = -(( 2.0 *    -5.0) + -2.0)
  
  TEST_PA_OP3_D( 8,  fmsub.d, 0, 0x4200000000000000, 0x4000000000000000, 0x4500000000000000, 0x4000000000000000); #                1.5 =   ( 1.0 *     2.5) -  1.0
  TEST_PA_OP3_D( 9,  fmsub.d, 0, 0x6468FFFFFFFFFFF3, 0xC000000000000000, 0x9B96733333333340, 0x4066666666666680); #               1234 =   (-1.0 * -1235.1) -  1.1
  TEST_PA_OP3_D(10,  fmsub.d, 0, 0xB400000000000000, 0x4400000000000000, 0xB700000000000000, 0xBC00000000000000); #               -8.0 =   ( 2.0 *    -5.0) - -2.0
  
  TEST_PA_OP3_D(11, fnmsub.d, 0, 0xBE00000000000000, 0x4000000000000000, 0x4500000000000000, 0x4000000000000000); #               -1.5 = -(( 1.0 *     2.5) -  1.0)
  TEST_PA_OP3_D(12, fnmsub.d, 0, 0x9B9700000000000D, 0xC000000000000000, 0x9B96733333333340, 0x4066666666666680); #              -1234 = -((-1.0 * -1235.1) -  1.1)
  TEST_PA_OP3_D(13, fnmsub.d, 0, 0x4C00000000000000, 0x4400000000000000, 0xB700000000000000, 0xBC00000000000000); #                8.0 = -(( 2.0 *    -5.0) - -2.0)

  TEST_PASSFAIL

RVTEST_CODE_END

  .data
RVTEST_DATA_BEGIN

  TEST_DATA

RVTEST_DATA_END
